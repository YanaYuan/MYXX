<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ‹è¯•æ–°çª—å£é¢„è§ˆåŠŸèƒ½</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .test-area {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        button {
            background: linear-gradient(135deg, #00d4ff, #ff00aa);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin: 10px 5px;
            transition: transform 0.3s ease;
        }
        
        button:hover {
            transform: translateY(-2px);
        }
        
        .log {
            background: #000;
            color: #0f0;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 14px;
            margin: 20px 0;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ æ–°çª—å£é¢„è§ˆåŠŸèƒ½æµ‹è¯•</h1>
        
        <div class="test-area">
            <h3>ğŸ§ª åŠŸèƒ½æµ‹è¯•æ­¥éª¤ï¼š</h3>
            <ol>
                <li>ç‚¹å‡»"æ¨¡æ‹Ÿç”ŸæˆPPT"æŒ‰é’® - æ¨¡æ‹Ÿç”ŸæˆHTMLå†…å®¹</li>
                <li>ç‚¹å‡»"æ–°çª—å£é¢„è§ˆ"æŒ‰é’® - æµ‹è¯•é¢„è§ˆåŠŸèƒ½</li>
                <li>æ£€æŸ¥æ˜¯å¦åœ¨æ–°æ ‡ç­¾é¡µä¸­æ­£ç¡®æ˜¾ç¤ºå†…å®¹</li>
            </ol>
            
            <div style="text-align: center; margin: 20px 0;">
                <button onclick="simulateGeneration()">ğŸ“ æ¨¡æ‹Ÿç”ŸæˆPPT</button>
                <button onclick="openInNewWindow()">ğŸš€ æ–°çª—å£é¢„è§ˆ</button>
                <button onclick="clearLog()">ğŸ§¹ æ¸…ç©ºæ—¥å¿—</button>
            </div>
        </div>
        
        <div class="log" id="log">
            <div>æµ‹è¯•ç¯å¢ƒå‡†å¤‡å°±ç»ª...</div>
        </div>
    </div>

    <script>
        function log(message) {
            const logDiv = document.getElementById('log');
            const time = new Date().toLocaleTimeString();
            logDiv.innerHTML += `<div>${time}: ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function clearLog() {
            document.getElementById('log').innerHTML = '<div>æ—¥å¿—å·²æ¸…ç©º...</div>';
        }

        function simulateGeneration() {
            log('ğŸ”„ å¼€å§‹æ¨¡æ‹ŸPPTç”Ÿæˆ...');
            
            // æ¨¡æ‹Ÿç”Ÿæˆçš„HTMLå†…å®¹
            const mockHTML = `
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¨¡æ‹Ÿç”Ÿæˆçš„PPTé¡µé¢</title>
    <style>
        body { 
            margin: 0; 
            padding: 50px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-family: 'Segoe UI', sans-serif;
            min-height: 100vh;
        }
        .content { 
            max-width: 1000px; 
            margin: 0 auto; 
            text-align: center; 
        }
        h1 { 
            font-size: 3.5rem; 
            margin-bottom: 2rem; 
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .feature { 
            background: rgba(255, 255, 255, 0.15); 
            padding: 25px; 
            border-radius: 15px; 
            margin: 20px 0; 
            backdrop-filter: blur(10px);
        }
    </style>
</head>
<body>
    <div class="content">
        <h1>ğŸ¯ æµ‹è¯•PPTé¡µé¢</h1>
        
        <div class="feature">
            <h3>âœ… æ–°çª—å£é¢„è§ˆåŠŸèƒ½æµ‹è¯•æˆåŠŸ</h3>
            <p>æ­¤é¡µé¢æ˜¯é€šè¿‡openInNewWindow()å‡½æ•°æ‰“å¼€çš„</p>
            <p>æ—¶é—´: ${new Date().toLocaleString()}</p>
        </div>
        
        <div class="feature">
            <h3>ğŸ“‹ æµ‹è¯•ç»“æœ</h3>
            <p>å¦‚æœæ‚¨èƒ½çœ‹åˆ°è¿™ä¸ªé¡µé¢ï¼Œè¯´æ˜æ–°çª—å£é¢„è§ˆåŠŸèƒ½æ­£å¸¸å·¥ä½œ</p>
        </div>
        
        <div class="feature">
            <h3>ğŸ‰ åŠŸèƒ½ç‰¹ç‚¹</h3>
            <ul style="text-align: left;">
                <li>âœ… åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€</li>
                <li>âœ… æ˜¾ç¤ºçº¯å‡€PPTå†…å®¹</li>
                <li>âœ… æ— taskbarè¦†ç›–</li>
                <li>âœ… ä¿æŒå®Œæ•´é¡µé¢å¸ƒå±€</li>
            </ul>
        </div>
    </div>
</body>
</html>`;

            // ä¿å­˜åˆ°å…¨å±€å˜é‡ï¼ˆæ¨¡æ‹Ÿç”ŸæˆæˆåŠŸåçš„æ“ä½œï¼‰
            window.generatedHTML = mockHTML;
            
            log('âœ… PPTå†…å®¹ç”ŸæˆæˆåŠŸ');
            log('ğŸ“Š HTMLé•¿åº¦: ' + mockHTML.length + ' å­—ç¬¦');
            log('ğŸ’¾ å†…å®¹å·²ä¿å­˜åˆ° window.generatedHTML');
            log('ğŸš€ ç°åœ¨å¯ä»¥ç‚¹å‡»"æ–°çª—å£é¢„è§ˆ"æŒ‰é’®æµ‹è¯•');
        }

        // æ–°çª—å£é¢„è§ˆåŠŸèƒ½ï¼ˆä¸ä¸»é¡µé¢ç›¸åŒçš„å®ç°ï¼‰
        function openInNewWindow() {
            log('ğŸš€ å°è¯•åœ¨æ–°çª—å£æ‰“å¼€PPTé¡µé¢');
            
            if (!window.generatedHTML) {
                log('âŒ æ²¡æœ‰å¯æ‰“å¼€çš„HTMLå†…å®¹');
                showToast('æ²¡æœ‰å¯é¢„è§ˆçš„PPTé¡µé¢ï¼Œè¯·å…ˆç‚¹å‡»"æ¨¡æ‹Ÿç”ŸæˆPPT"', 'error');
                return;
            }

            try {
                // ç›´æ¥ä½¿ç”¨ä¿å­˜çš„HTMLå†…å®¹ï¼Œæ— taskbar
                const finalHTML = window.generatedHTML;
                
                log('ğŸ“„ å‡†å¤‡æ‰“å¼€æ–°æ ‡ç­¾é¡µ...');
                
                // åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€
                const newTab = window.open('', '_blank');
                
                if (newTab) {
                    // å†™å…¥HTMLå†…å®¹
                    newTab.document.write(finalHTML);
                    newTab.document.close();
                    
                    log('âœ… PPTé¡µé¢å·²åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€');
                    showToast('PPTé¡µé¢å·²åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€', 'success');
                } else {
                    log('âŒ æ— æ³•æ‰“å¼€æ–°æ ‡ç­¾é¡µ');
                    showToast('æ— æ³•æ‰“å¼€æ–°æ ‡ç­¾é¡µï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨å¼¹çª—è®¾ç½®', 'error');
                }
            } catch (error) {
                log('âŒ æ‰“å¼€æ–°çª—å£å¤±è´¥: ' + error.message);
                showToast('æ‰“å¼€é¢„è§ˆå¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // ç®€å•çš„Toastæç¤ºåŠŸèƒ½
        function showToast(message, type = 'info') {
            log('ğŸ’¬ æ˜¾ç¤ºæç¤º: ' + message);
            
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 25px;
                border-radius: 8px;
                color: white;
                font-weight: 600;
                z-index: 9999;
                transform: translateX(100%);
                transition: transform 0.3s ease;
                max-width: 400px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                background: ${type === 'success' ? '#28a745' : '#dc3545'};
            `;
            
            const icon = type === 'success' ? 'âœ…' : 'âŒ';
            toast.innerHTML = `${icon} ${message}`;

            document.body.appendChild(toast);

            setTimeout(() => {
                toast.style.transform = 'translateX(0)';
            }, 100);

            setTimeout(() => {
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (document.body.contains(toast)) {
                        document.body.removeChild(toast);
                    }
                }, 300);
            }, 3000);
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.addEventListener('load', function() {
            log('ğŸ® æµ‹è¯•ç¯å¢ƒåˆå§‹åŒ–å®Œæˆ');
            log('ğŸ“ é¦–å…ˆç‚¹å‡»"æ¨¡æ‹Ÿç”ŸæˆPPT"æ¥å‡†å¤‡æµ‹è¯•æ•°æ®');
        });
    </script>
</body>
</html>
